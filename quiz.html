<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>互动小问答</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container center">
    <h2>🎁 互动小问答 🎁</h2>

    <div class="q">你最希望实现的愿望是？</div>
    <div class="opts">
      <button class="opt" data-pop="💰 金币从天而降！一夜暴富~">A. 一夜暴富</button>
      <button class="opt" data-pop="🌿 谢谢你，我会照顾好自己。">B. 健康平安</button>
      <button class="opt" data-pop="🏠 我永远记得你给的温暖。">C. 家庭和睦</button>
      <button class="opt" data-pop="🌈 愿好运常伴你身边！">D. 万事顺意</button>
    </div>

    <div class="q">你打开这个网页的第一反应？</div>
    <div class="opts">
      <button class="opt" data-pop="当然是我亲手写的！">A. 这是我宝贝做的吗？</button>
      <button class="opt" data-pop="不许哭！我还会一直做~">B. 这么有心？眼睛有点酸…</button>
      <button class="opt" data-pop="嘿嘿，我是不是有点厉害！">C. 还带互动？</button>
      <button class="opt" data-pop="对呀，这首歌我挑了好久～">D. 还有音乐！</button>
    </div>

    <div class="q">你觉得我是什么样的小孩？</div>
    <div class="opts">
      <button class="opt" data-pop="你们的爱我都记在心上。">A. 贴心</button>
      <button class="opt" data-pop="放心，我会好好过自己的人生。">B. 有主见</button>
      <button class="opt" data-pop="是因为我在长大呀。">C. 偶尔有点叛逆</button>
      <button class="opt" data-pop="我可是你们的小狐狸~">D. 脾气臭但嘴甜</button>
    </div>

    <div class="q">你希望我接下来最该做的是什么？</div>
    <div class="opts">
      <button class="opt" data-pop="我知道啦！已经在学了。">A. 好好读书！</button>
      <button class="opt" data-pop="答应你，不让你们想我太久。">B. 多回家看看</button>
      <button class="opt" data-pop="不急，遇到对的人才有趣。">C. 谈个靠谱恋爱</button>
      <button class="opt" data-pop="你怎么知道我昨天又三点睡…">D. 吃饱睡好不熬夜</button>
    </div>

    <div class="panel">
      <a class="btn" id="goWish" href="wish.html">去许愿 →</a>
    </div>
  </div>

 <!-- 放在页面底部按钮面板附近 -->
<audio id="bgm" src="a little story.mp3"></audio>

<script>
// 与祝福页一致的续播逻辑（只“续播”，不“首播”）
const KEY = 'bgmProgress';
const audio = document.getElementById('bgm');

function save() {
  try {
    sessionStorage.setItem(KEY, JSON.stringify({
      t: audio.currentTime,
      playing: !audio.paused,
      src: audio.currentSrc
    }));
  } catch(e){}
}
async function resume() {
  const s = JSON.parse(sessionStorage.getItem(KEY) || '{}');
  if (s.src === audio.currentSrc && typeof s.t === 'number') {
    audio.currentTime = Math.max(0, s.t - 0.3);
  }
  if (s.playing) {
    try { await audio.play(); } catch(e){}
  }
}
setInterval(save, 1000);
window.addEventListener('beforeunload', save);
document.addEventListener('visibilitychange', () => { if (document.hidden) save(); });
resume();
</script>


  <script>
    const conf = ["🎉","✨","🎊","💖","💫","🌟"];
    function pop(text){
      alert(text);
      for(let i=0;i<12;i++){
        const s = document.createElement('div');
        s.className='fetti';
        s.textContent = conf[Math.floor(Math.random()*conf.length)];
        s.style.left = (10+Math.random()*80)+'%';
        s.style.fontSize = (18+Math.random()*18)+'px';
        document.body.appendChild(s);
        setTimeout(()=>s.remove(),2200);
      }
    }
    document.querySelectorAll('.opt').forEach(el=>{
      el.addEventListener('click',()=>pop(el.dataset.pop));
    });
    // 读取身份并拼接跳转
    const who = new URLSearchParams(location.search).get('for') || sessionStorage.getItem('who') || 'dad';
    sessionStorage.setItem('who',who);
    document.getElementById('goWish').href = 'wish.html?for='+who;
  </script>
</body>
</html>
